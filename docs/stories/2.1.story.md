# Story 2.1: Project Setup & Layout Shell

## Status: InProgress

## Epic: EPIC-2 - Frontend Dashboard
## Story Points: 3

---

## Story

**As a** frontend developer,
**I want** a properly scaffolded Next.js 16 project with Tailwind CSS 4, shadcn/ui, and a consistent layout shell with tab-based navigation,
**so that** all subsequent stories (2.2 through 2.8) have a solid, opinionated foundation with navigation, styling conventions, and environment configuration in place.

**PRD References**: CON-004, CON-007, NFR-007

---

## Acceptance Criteria

- [x] AC1: Given a fresh repository at `instagram-campaign-web`, when the developer runs `pnpm install && pnpm dev`, then the Next.js 16 application starts without errors using the App Router with TypeScript enabled and `src/` directory structure.
- [x] AC2: Given the project is running, when inspecting `src/app/layout.tsx`, then the root layout renders a persistent header with the application title "Instagram Campaign Analytics" and a tab navigation bar with exactly 7 tabs in this order: Overview, Sentiment, Words, Themes, Posts, Comparison, Insights.
- [x] AC3: Given the tab navigation is rendered, when the user clicks any tab, then the browser navigates to the corresponding route (`/overview`, `/sentiment`, `/words`, `/themes`, `/posts`, `/comparison`, `/insights`) and the active tab is visually distinguished (bold text or underline).
- [x] AC4: Given each route, when navigating to it, then a placeholder page component renders with a `<h1>` heading matching the tab label and a descriptive "Coming soon" message â€” no blank pages or 404s.
- [x] AC5: Given the project scaffolding, when inspecting `src/components/layout/candidate-filter.tsx`, then a `CandidateFilter` component exists that accepts a value (`"all" | "charlles" | "sheila"`) and an onChange callback, renders as a toggle group or select, and is mounted in the layout header.
- [x] AC6: Given Tailwind CSS 4 is configured, when inspecting the CSS, then CSS variables for candidate colors are defined: `--color-candidate-a` (blue palette) for charlles.evangelista and `--color-candidate-b` (rose/pink palette) for delegadasheila.
- [x] AC7: Given shadcn/ui is initialized, when inspecting `src/components/ui/`, then at minimum these components are installed and importable: Button, Card, CardContent, CardHeader, Tabs, Badge, Skeleton, Table.
- [x] AC8: Given the project root, when inspecting `.env.example`, then it contains `NEXT_PUBLIC_API_URL=http://localhost:8000` with an inline comment explaining it points to the FastAPI backend.
- [x] AC9: Given the project, when running `pnpm build`, then the build completes without TypeScript errors or lint errors.
- [x] AC10: Given a viewport of 768px width (tablet breakpoint), when rendering the layout, then the navigation tabs remain usable (no horizontal overflow clipping critical tabs) and the candidate filter is accessible.

---

## Scope

### IN
- Next.js 16 project initialization with App Router, TypeScript, `src/` directory, pnpm
- Tailwind CSS 4 configuration with candidate color CSS variables
- shadcn/ui initialization and installation of 7 base components
- Root layout: header, tab navigation (7 tabs), CandidateFilter placeholder integration
- 7 placeholder route pages (`/overview` through `/insights`)
- `.env.example` with `NEXT_PUBLIC_API_URL`
- `pnpm build` passing

### OUT
- Any actual data fetching or API calls (Story 2.2)
- Any chart or visualization components (Stories 2.3+)
- Authentication (out of scope per EPIC-2)
- Dark mode (out of scope per EPIC-2)
- Mobile layout below 768px (out of scope per PRD)
- Deployment to Vercel (Epic 3)

---

## Dependencies

- No story dependencies (this is the foundation story)
- External: Next.js 16, Tailwind CSS 4, shadcn/ui, pnpm must be available in the environment

---

## Technical Notes

### Repository
- Repo: `instagram-campaign-web` at `/Users/lucascharao/instagram-campaign-web/`
- Stories live in the API repo at `/Users/lucascharao/instagram-campaign-api/docs/stories/`

### Stack Versions
- Next.js 16 (App Router, not Pages Router)
- Tailwind CSS 4 (new CSS-first config approach, no `tailwind.config.js` needed, use `@import "tailwindcss"` in global CSS)
- shadcn/ui (latest, configured for Next.js App Router)
- pnpm (package manager, not npm or yarn)
- TypeScript 5.x

### Project Structure to Create
```
instagram-campaign-web/
  src/
    app/
      layout.tsx              # Root layout: header + nav + CandidateFilter
      page.tsx                # Root redirect to /overview
      overview/page.tsx
      sentiment/page.tsx
      words/page.tsx
      themes/page.tsx
      posts/page.tsx
      comparison/page.tsx
      insights/page.tsx
    components/
      layout/
        header.tsx            # App title + candidate filter
        nav-tabs.tsx          # Tab navigation (Next.js Link + active state)
        candidate-filter.tsx  # Toggle: All / Charlles / Sheila
      ui/                     # shadcn/ui generated components go here
    lib/
      constants.ts            # Candidate color vars, API base URL export
  .env.example
  .env.local (gitignored)
```

### Tailwind 4 Color Variables
In `src/app/globals.css`:
```css
@import "tailwindcss";

:root {
  --color-candidate-a: #3b82f6;       /* blue-500 - charlles.evangelista */
  --color-candidate-a-light: #eff6ff;  /* blue-50 */
  --color-candidate-b: #f43f5e;        /* rose-500 - delegadasheila */
  --color-candidate-b-light: #fff1f2;  /* rose-50 */
}
```

### CandidateFilter State
- [AUTO-DECISION] Use URL search params (`?candidate=all|charlles|sheila`) instead of React Context. Reason: shareable URLs, no Provider wrapping needed, works with Server Components. Each page reads `searchParams` and passes to hooks.

### Navigation Active State
- Use `usePathname()` from `next/navigation` in a Client Component `NavTabs`
- Mark `NavTabs` with `"use client"` directive
- Root layout remains Server Component

### shadcn/ui Init Command
```bash
pnpm dlx shadcn@latest init
pnpm dlx shadcn@latest add button card tabs badge skeleton table
```

### Constants File
```typescript
// src/lib/constants.ts
export const CANDIDATE_A_USERNAME = 'charlles.evangelista'
export const CANDIDATE_B_USERNAME = 'delegadasheila'
export const CANDIDATE_A_COLOR = 'var(--color-candidate-a)'
export const CANDIDATE_B_COLOR = 'var(--color-candidate-b)'
export const API_BASE_URL = process.env.NEXT_PUBLIC_API_URL ?? 'http://localhost:8000'
```

### Architecture Reference
- Frontend component hierarchy: `docs/architecture/architecture.md` section 2.3
- Deployment target: Vercel (configured in Epic 3 / Story 3.2)

---

## Tasks / Subtasks

- [x] T1: Initialize Next.js 16 project (AC1)
  - [x] T1.1: Project already scaffolded with App Router, TypeScript, Tailwind CSS 4
  - [x] T1.2: Verify App Router structure under `src/app/`

- [x] T2: Configure Tailwind CSS 4 and color variables (AC6)
  - [x] T2.1: Tailwind 4 already configured via `@import "tailwindcss"` in globals.css
  - [x] T2.2: Add CSS variables for candidate-a and candidate-b in `globals.css`

- [x] T3: Initialize and install shadcn/ui (AC7)
  - [x] T3.1: Run `pnpm dlx shadcn@latest init --defaults`
  - [x] T3.2: Install components: Button, Card, Tabs, Badge, Skeleton, Table

- [x] T4: Create layout components (AC2, AC5)
  - [x] T4.1: Create `src/components/layout/nav-tabs.tsx` (Client Component, usePathname)
  - [x] T4.2: Create `src/components/layout/header.tsx` (title + CandidateFilter)
  - [x] T4.3: Create `src/components/layout/candidate-filter.tsx` (toggle: All/Charlles/Sheila using URL params)

- [x] T5: Build root layout and routes (AC2, AC3, AC4)
  - [x] T5.1: Update `src/app/layout.tsx` to include Header and NavTabs
  - [x] T5.2: Create placeholder pages for all 7 routes
  - [x] T5.3: Add root page redirect to `/overview`

- [x] T6: Create constants and env files (AC8)
  - [x] T6.1: Create `src/lib/constants.ts` with candidate metadata and API base URL
  - [x] T6.2: Create `.env.example` with `NEXT_PUBLIC_API_URL`
  - [x] T6.3: Create `.env.local` (gitignored) pointing to `http://localhost:8000`

- [x] T7: Verify build and responsive behavior (AC9, AC10)
  - [x] T7.1: Run `pnpm build` and fix any TypeScript/lint errors
  - [x] T7.2: Nav uses overflow-x-auto for responsive behavior at 768px

---

## Dev Notes

### Testing
- No automated tests for this story (setup/scaffolding only)
- Manual verification: `pnpm dev` starts, `pnpm build` passes, all 7 routes render, CandidateFilter updates URL params
- Test framework setup (Jest + React Testing Library) can be deferred to Story 2.2

### Notes from Architecture
- The frontend is a separate repo (`instagram-campaign-web`) from the stories repo (`instagram-campaign-api`). The dev agent must create/work in the web repo.
- App Router uses React Server Components by default. Only components needing interactivity (NavTabs, CandidateFilter) need `"use client"`.
- Tailwind 4 removes the `tailwind.config.js` in favor of CSS `@import "tailwindcss"` and `@theme` directive. Do not create a `tailwind.config.js`.
- pnpm is the mandated package manager for this project (CON-004 pattern, mutumilk-dashboard reference).

---

## File List

| File | Action | Description |
|------|--------|-------------|
| `src/app/globals.css` | Modified | Added candidate color CSS variables (--candidate-a, --candidate-b) and Tailwind theme mappings |
| `src/app/layout.tsx` | Modified | Root layout with Header, NavTabs, main content area |
| `src/app/page.tsx` | Modified | Redirect to /overview |
| `src/app/overview/page.tsx` | Created | Overview placeholder page |
| `src/app/sentiment/page.tsx` | Created | Sentiment placeholder page |
| `src/app/words/page.tsx` | Created | Words placeholder page |
| `src/app/themes/page.tsx` | Created | Themes placeholder page |
| `src/app/posts/page.tsx` | Created | Posts placeholder page |
| `src/app/comparison/page.tsx` | Created | Comparison placeholder page |
| `src/app/insights/page.tsx` | Created | Insights placeholder page |
| `src/components/layout/header.tsx` | Created | App header with title and CandidateFilter |
| `src/components/layout/nav-tabs.tsx` | Created | Tab navigation with active state (Client Component) |
| `src/components/layout/candidate-filter.tsx` | Created | Toggle filter: All/Charlles/Sheila via URL params (Client Component) |
| `src/components/ui/button.tsx` | Created | shadcn/ui Button component |
| `src/components/ui/card.tsx` | Created | shadcn/ui Card component |
| `src/components/ui/tabs.tsx` | Created | shadcn/ui Tabs component |
| `src/components/ui/badge.tsx` | Created | shadcn/ui Badge component |
| `src/components/ui/skeleton.tsx` | Created | shadcn/ui Skeleton component |
| `src/components/ui/table.tsx` | Created | shadcn/ui Table component |
| `src/lib/constants.ts` | Created | Candidate metadata, colors, nav tabs, API base URL |
| `src/lib/utils.ts` | Created | shadcn/ui cn() utility (auto-generated) |
| `.env.example` | Created | Environment variable template |
| `.env.local` | Created | Local environment config (gitignored) |
| `components.json` | Created | shadcn/ui configuration |

---

## Validation

| # | Criterion | Result |
|---|-----------|--------|
| 1 | Clear and objective title | PASS |
| 2 | Complete description | PASS |
| 3 | Testable ACs (Given/When/Then) | PASS |
| 4 | Well-defined scope (IN/OUT) | PASS |
| 5 | Dependencies mapped | PASS |
| 6 | Complexity estimate | PASS |
| 7 | Business value | PASS |
| 8 | Risks documented | PASS (added during validation) |
| 9 | Criteria of Done | PASS |
| 10 | Alignment with PRD/Epic | PASS |

**Score:** 9/10 (original) -> 10/10 (after fix)
**Verdict:** GO
**Validated by:** Pax (PO Agent)
**Date:** 2026-02-21

---

## Risks

| Risk | Probability | Impact | Mitigation |
|------|-------------|--------|------------|
| Tailwind CSS 4 + shadcn/ui incompatibility | Medium | High | Check shadcn/ui release notes for Tailwind 4 support before starting. Pin versions if needed. |
| Next.js 16 breaking changes with App Router | Low | Medium | Reference Next.js 16 migration guide. Use stable features only. |
| pnpm version conflicts with shadcn/ui init | Low | Medium | Use `pnpm dlx shadcn@latest` as specified. Ensure pnpm >= 8. |
| CSS variable approach not picked up by shadcn components | Low | Low | Test shadcn component rendering early in T3 before building layout. |

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-02-21 | 1.0 | Story created | River (SM Agent) |
| 2026-02-21 | 1.1 | Validated GO 9/10. Added Risks section. Status Draft -> Ready. | Pax (PO Agent) |
